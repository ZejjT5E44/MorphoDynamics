
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>morphodynamics package &#8212; Morphodynamics documentation</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet">
  <link href="../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="morphodynamics.plots package" href="morphodynamics.plots.html" />
    <link rel="prev" title="Data formats" href="../../mydocs/Data.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Morphodynamics documentation</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../mydocs/Introduction.html">
   Overview
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Getting started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../mydocs/Installation.html">
   Installation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../mydocs/Napari_Plugin.html">
   Napari plugin for Morphodynamics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../mydocs/Analysis_with_morpho_segmentation.html">
   Segmentation and windowing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../mydocs/Analysis_without_UI.html">
   Segmentation and windowing without UI
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../mydocs/Data_analysis.html">
   Data analysis
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Code and algorithms
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../mydocs/usage_step_by_step.html">
   Analysis step by step
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../mydocs/code_structure.html">
   General code structure
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../mydocs/segmentation.html">
   Segmentation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../mydocs/Data.html">
   Data formats
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Reference
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active has-children">
  <a class="current reference internal" href="#">
   morphodynamics package
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="morphodynamics.plots.html">
     morphodynamics.plots package
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="morphodynamics.store.html">
     morphodynamics.store package
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/docs/source/morphodynamics.rst"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.rst</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/guiwitz/MorphoDynamics"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#subpackages">
   Subpackages
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#submodules">
   Submodules
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-morphodynamics.analysis_par">
   morphodynamics.analysis_par module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-morphodynamics.correlation">
   morphodynamics.correlation module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-morphodynamics.displacementestimation">
   morphodynamics.displacementestimation module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-morphodynamics.folders">
   morphodynamics.folders module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-morphodynamics.functionaldefinition">
   morphodynamics.functionaldefinition module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-morphodynamics.morpho_segmentation">
   morphodynamics.morpho_segmentation module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-morphodynamics.segmentation">
   morphodynamics.segmentation module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-morphodynamics.splineutils">
   morphodynamics.splineutils module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-morphodynamics.syntheticdata">
   morphodynamics.syntheticdata module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-morphodynamics.utils">
   morphodynamics.utils module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-morphodynamics.windowing">
   morphodynamics.windowing module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-morphodynamics">
   Module contents
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>morphodynamics package</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#subpackages">
   Subpackages
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#submodules">
   Submodules
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-morphodynamics.analysis_par">
   morphodynamics.analysis_par module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-morphodynamics.correlation">
   morphodynamics.correlation module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-morphodynamics.displacementestimation">
   morphodynamics.displacementestimation module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-morphodynamics.folders">
   morphodynamics.folders module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-morphodynamics.functionaldefinition">
   morphodynamics.functionaldefinition module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-morphodynamics.morpho_segmentation">
   morphodynamics.morpho_segmentation module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-morphodynamics.segmentation">
   morphodynamics.segmentation module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-morphodynamics.splineutils">
   morphodynamics.splineutils module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-morphodynamics.syntheticdata">
   morphodynamics.syntheticdata module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-morphodynamics.utils">
   morphodynamics.utils module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-morphodynamics.windowing">
   morphodynamics.windowing module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-morphodynamics">
   Module contents
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="section" id="morphodynamics-package">
<h1>morphodynamics package<a class="headerlink" href="#morphodynamics-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="morphodynamics.plots.html">morphodynamics.plots package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="morphodynamics.plots.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="morphodynamics.plots.html#module-morphodynamics.plots.animate_plots">morphodynamics.plots.animate_plots module</a></li>
<li class="toctree-l2"><a class="reference internal" href="morphodynamics.plots.html#module-morphodynamics.plots.show_plots">morphodynamics.plots.show_plots module</a></li>
<li class="toctree-l2"><a class="reference internal" href="morphodynamics.plots.html#module-morphodynamics.plots.ui_wimage">morphodynamics.plots.ui_wimage module</a></li>
<li class="toctree-l2"><a class="reference internal" href="morphodynamics.plots.html#module-morphodynamics.plots">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="morphodynamics.store.html">morphodynamics.store package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="morphodynamics.store.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="morphodynamics.store.html#module-morphodynamics.store.dataset">morphodynamics.store.dataset module</a></li>
<li class="toctree-l2"><a class="reference internal" href="morphodynamics.store.html#module-morphodynamics.store.parameters">morphodynamics.store.parameters module</a></li>
<li class="toctree-l2"><a class="reference internal" href="morphodynamics.store.html#module-morphodynamics.store.results">morphodynamics.store.results module</a></li>
<li class="toctree-l2"><a class="reference internal" href="morphodynamics.store.html#module-morphodynamics.store">Module contents</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-morphodynamics.analysis_par">
<span id="morphodynamics-analysis-par-module"></span><h2>morphodynamics.analysis_par module<a class="headerlink" href="#module-morphodynamics.analysis_par" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="morphodynamics.analysis_par.align_all">
<span class="sig-prename descclassname"><span class="pre">morphodynamics.analysis_par.</span></span><span class="sig-name descname"><span class="pre">align_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s_all</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">im_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_points</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">client</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.analysis_par.align_all" title="Permalink to this definition">¶</a></dt>
<dd><p>Align all successive pairs of splines and generate for each spline
a rasterized version.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>s_all</strong> (<em>dict of splines</em>) – each element k is the spline of frame k</p></li>
<li><p><strong>im_shape</strong> (<em>tuple</em>) – intended shape of rasterized image</p></li>
<li><p><strong>num_points</strong> (<em>int</em>) – number of estimated spline points</p></li>
<li><p><strong>param</strong> (<em>Param object</em>) – As created by morphodyanmics.parameters.Param</p></li>
<li><p><strong>client</strong> (<em>dask client</em><em>, </em><em>optional</em>) – client connected to LocalCluster or SLURMCluster</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>s0prm_all</strong> (<em>dict of splines</em>) – each element k is the spline of frame k xy-aligned
on spline of frame k+1</p></li>
<li><p><strong>c_all</strong> (<em>dict of 2d arrays</em>) – each element is the rasterized contour</p></li>
<li><p><strong>ori_all</strong> (<em>dict of floats</em>) – each element k is the spline parameter shift to align
spline of frame k on spline of frame k-1</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="morphodynamics.analysis_par.analyze_morphodynamics">
<span class="sig-prename descclassname"><span class="pre">morphodynamics.analysis_par.</span></span><span class="sig-name descname"><span class="pre">analyze_morphodynamics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">client</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">only_seg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_seg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_segtrack</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.analysis_par.analyze_morphodynamics" title="Permalink to this definition">¶</a></dt>
<dd><p>Main function performing segmentation, windowing, signal
extraction and displacement matching.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>data object</em>) – as returned by morphodynamics.dataset</p></li>
<li><p><strong>param</strong> (<em>Param object</em>) – As created by morphodyanmics.parameters.Param</p></li>
<li><p><strong>client</strong> (<em>dask client</em><em>, </em><em>optional</em>) – client can be connected to either LocalCluster or SLURMCLuster</p></li>
<li><p><strong>only_seg</strong> (<em>bool</em>) – Perfrom only segmentation without windowing</p></li>
<li><p><strong>keep_seg</strong> (<em>bool</em>) – Store segmentation masks in memory</p></li>
<li><p><strong>skip_segtrack</strong> (<em>bool</em>) – Skip segmentation and tracking (only possible if done previously)</p></li>
<li><p><strong>model</strong> (<em>convpaint random forest model</em><em>, </em><em>optional</em>) – Segmentation model generated by napari convpaint plugin
only used if param.seg_algo == “conv_paint”</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>res</strong> – as created by morphodyanmics.results.Result</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Result object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="morphodynamics.analysis_par.calibration">
<span class="sig-prename descclassname"><span class="pre">morphodynamics.analysis_par.</span></span><span class="sig-name descname"><span class="pre">calibration</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.analysis_par.calibration" title="Permalink to this definition">¶</a></dt>
<dd><p>Segment the first frame to determine the initial location
(if not provided) as well as the number of windows.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>data object</em>) – as returned by morphodynamics.dataset</p></li>
<li><p><strong>param</strong> (<em>Param object</em>) – As created by morphodyanmics.parameters.Param</p></li>
<li><p><strong>model</strong> (<em>convpaint model</em><em>, </em><em>optional</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>location</strong> (<em>tuple</em>) – x,y location of cell</p></li>
<li><p><strong>J</strong> (<em>int</em>) – number of window layers</p></li>
<li><p><strong>I</strong> (<em>list of int</em>) – number of windows per layer</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="morphodynamics.analysis_par.compute_displacement">
<span class="sig-prename descclassname"><span class="pre">morphodynamics.analysis_par.</span></span><span class="sig-name descname"><span class="pre">compute_displacement</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s_all</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_all</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0_all</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.analysis_par.compute_displacement" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute displacement between pairs of successive splines.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>s_all</strong> (<em>dict of spline objects</em>) – each element k of the dictionary contains the spline of the
corresponding frame k. The frame k-1 contains None</p></li>
<li><p><strong>t_all</strong> (<em>dict of 1d array</em>) – each element is a list of spline parameters defining closest locations
on s_all[t] to points defined by t0_all on s_all[t-1]</p></li>
<li><p><strong>t0_all</strong> (<em>1d array</em>) – each element is a list of spline paramters defining points centered on
windows of frame corresponding to s_all[t-1]</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="morphodynamics.analysis_par.compute_spline_windows">
<span class="sig-prename descclassname"><span class="pre">morphodynamics.analysis_par.</span></span><span class="sig-name descname"><span class="pre">compute_spline_windows</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">param</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.analysis_par.compute_spline_windows" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute spline coordinates and window image for time point t</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>param</strong> (<em>param object</em>) – </p></li>
<li><p><strong>k</strong> (<em>int</em>) – frame</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>image</strong> (<em>2d array</em>) – current frame</p></li>
<li><p><strong>spline_coord</strong> (<em>list of 1d arrays</em>) – spline coordines</p></li>
<li><p><strong>im_window</strong> (<em>2d array</em>) – window image (pixel of each window have given value)</p></li>
<li><p><strong>windows</strong> (<em>3d list</em>) – list of window indices as output by create_windows()</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="morphodynamics.analysis_par.extract_signal_all">
<span class="sig-prename descclassname"><span class="pre">morphodynamics.analysis_par.</span></span><span class="sig-name descname"><span class="pre">extract_signal_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">J</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">I</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.analysis_par.extract_signal_all" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract signals from all frames.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>data object</em>) – as returned by morphodynamics.dataset</p></li>
<li><p><strong>param</strong> (<em>Param object</em>) – As created by morphodyanmics.parameters.Param</p></li>
<li><p><strong>J</strong> (<em>int</em>) – number of window layers</p></li>
<li><p><strong>I</strong> (<em>list of int</em>) – number of windows per layer</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>mean_signal</strong> (<em>4d array</em>) – array with mean signal per window in all dimensions</p></li>
<li><p><strong>var_signal</strong> (<em>4d array</em>) – array with variance of signal per window in all dimensions</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="morphodynamics.analysis_par.import_and_spline">
<span class="sig-prename descclassname"><span class="pre">morphodynamics.analysis_par.</span></span><span class="sig-name descname"><span class="pre">import_and_spline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smoothing</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.analysis_par.import_and_spline" title="Permalink to this definition">¶</a></dt>
<dd><p>Import binary image at image_path and fit a spline to its contour.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image_path</strong> (<em>path</em>) – path to binary image</p></li>
<li><p><strong>smoothing</strong> (<em>float</em>) – smoothing factor for spline (see splrep)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>s</strong> – spline fitted to binary object in image</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>spline object (tuple)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="morphodynamics.analysis_par.segment_all">
<span class="sig-prename descclassname"><span class="pre">morphodynamics.analysis_par.</span></span><span class="sig-name descname"><span class="pre">segment_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">client</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.analysis_par.segment_all" title="Permalink to this definition">¶</a></dt>
<dd><p>Segment all frames and return a list of labelled masks. The correct
label is not selected here</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>data object</em>) – as returned by morphodynamics.dataset</p></li>
<li><p><strong>param</strong> (<em>Param object</em>) – As created by morphodyanmics.parameters.Param</p></li>
<li><p><strong>client</strong> (<em>dask client</em>) – client connected to LocalCluster or SLURMCluster, optional</p></li>
<li><p><strong>model</strong> (<em>random forest model</em><em>, </em><em>optional</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>segmented</strong> – list of labelled arrays</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of 2d arrays</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="morphodynamics.analysis_par.segment_single_frame">
<span class="sig-prename descclassname"><span class="pre">morphodynamics.analysis_par.</span></span><span class="sig-name descname"><span class="pre">segment_single_frame</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">param</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_image</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.analysis_par.segment_single_frame" title="Permalink to this definition">¶</a></dt>
<dd><p>Segment frame k of segmentation image defined in param object
and save to disk.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>param</strong> (<em>Param object</em>) – As created by morphodyanmics.parameters.Param</p></li>
<li><p><strong>k</strong> (<em>int</em>) – frame index</p></li>
<li><p><strong>save_path</strong> (<em>path</em>) – path to folder where to save segmented image</p></li>
<li><p><strong>model</strong> (<em>sklearn model</em>) – random forest model to use for segmentation</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="morphodynamics.analysis_par.spline_align_rasterize">
<span class="sig-prename descclassname"><span class="pre">morphodynamics.analysis_par.</span></span><span class="sig-name descname"><span class="pre">spline_align_rasterize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">im_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">align</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.analysis_par.spline_align_rasterize" title="Permalink to this definition">¶</a></dt>
<dd><p>Align a spline s with another spline s0 and provide a rasterized
version of it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>N</strong> (<em>int</em>) – number of points used for spline discretization</p></li>
<li><p><strong>s0</strong> (<em>tuple bspline object</em>) – spline at time t-1</p></li>
<li><p><strong>s</strong> (<em>tuple bspline object</em>) – spline at time t</p></li>
<li><p><strong>im_shape</strong> (<em>tuple</em>) – size of image for rasterization</p></li>
<li><p><strong>align</strong> (<em>bool</em>) – do alignement necessary or not</p></li>
<li><p><strong>filename</strong> (<em>path</em>) – file name to save rasterized image</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>s0_shifted</strong> (<em>tuple spline object</em>) – shifted version of s0 matching s</p></li>
<li><p><strong>c</strong> (<em>2d array</em>) – rasterized version of s</p></li>
<li><p><strong>origin</strong> (<em>float</em>) – spline parameter shift to align s origin on
s0 origin</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="morphodynamics.analysis_par.spline_all">
<span class="sig-prename descclassname"><span class="pre">morphodynamics.analysis_par.</span></span><span class="sig-name descname"><span class="pre">spline_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_frames</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smoothing</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">client</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.analysis_par.spline_all" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a series of segmented binary masks into splines.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_frames</strong> (<em>int</em>) – number of frames to analyze</p></li>
<li><p><strong>smoothing</strong> (<em>float</em>) – smoothing parameter used by splprep</p></li>
<li><p><strong>param</strong> (<em>Param object</em>) – As created by morphodyanmics.parameters.Param</p></li>
<li><p><strong>client</strong> (<em>dask client</em><em>, </em><em>optional</em>) – client connected to LocalCluster or SLURMCLuster</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>s_all</strong> – each element k of the dictionary contains the spline of the
corresponding frame k. The frame k-1 contains None</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict of spline objects</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="morphodynamics.analysis_par.track_all">
<span class="sig-prename descclassname"><span class="pre">morphodynamics.analysis_par.</span></span><span class="sig-name descname"><span class="pre">track_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">segmented</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">location</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.analysis_par.track_all" title="Permalink to this definition">¶</a></dt>
<dd><p>Turn the labelled arrays of segmented into binary images
where one labelled object has been selected as cell</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>segmented</strong> (<em>list of 2d arrays</em>) – list of labelled images</p></li>
<li><p><strong>location</strong> (<em>tuple</em>) – x,y location to use for tracking across frames</p></li>
<li><p><strong>param</strong> (<em>Param object</em>) – As created by morphodyanmics.parameters.Param</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>segmented</strong> – list of binary images</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of 2d arrays</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="morphodynamics.analysis_par.window_map">
<span class="sig-prename descclassname"><span class="pre">morphodynamics.analysis_par.</span></span><span class="sig-name descname"><span class="pre">window_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ori</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ori0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s0_shifted</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">J</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">I</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_iter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.analysis_par.window_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Create windows for spline s and map its position to spline of
previous frame s0 to measure displacements.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>N</strong> (<em>int</em>) – number of points used for spline discretization</p></li>
<li><p><strong>s</strong> (<em>tuple bspline object</em>) – spline to align</p></li>
<li><p><strong>s0</strong> (<em>tuple bspline object</em>) – spline to align to</p></li>
<li><p><strong>ori</strong> (<em>float</em>) – spline parameter shift to align s origin</p></li>
<li><p><strong>ori0</strong> (<em>float</em>) – spline parameter shift to align s0 origin</p></li>
<li><p><strong>s0_shifted</strong> (<em>tuple bspline object</em>) – shifted version of s0 xy-aligned on s</p></li>
<li><p><strong>J</strong> (<em>int</em>) – number of window layers</p></li>
<li><p><strong>I</strong> (<em>list of int</em>) – number of windows per layer</p></li>
<li><p><strong>k_iter</strong> (<em>int</em>) – frame index</p></li>
<li><p><strong>param</strong> (<em>Param object</em>) – As created by morphodyanmics.parameters.Param</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>t</strong> (<em>1d array</em>) – list of spline parameters defining closest locations
on s to points defined by t0 on s0</p></li>
<li><p><strong>t0</strong> (<em>1d array</em>) – list of spline paramters defining points centered on
windows of frame corresponding to s0</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="morphodynamics.analysis_par.window_map_all">
<span class="sig-prename descclassname"><span class="pre">morphodynamics.analysis_par.</span></span><span class="sig-name descname"><span class="pre">window_map_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s_all</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s_shift_all</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">J</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">I</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">origins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_points</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">im_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">client</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.analysis_par.window_map_all" title="Permalink to this definition">¶</a></dt>
<dd><p>Map all pairs of consecutive splines in s_all to minimize their
“distance” as defined by a chosen functional. Return the set of
optimized spline parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>s_all</strong> (<em>dict of spline objects</em>) – each element k of the dictionary contains the spline of the
corresponding frame k. The frame k-1 contains None</p></li>
<li><p><strong>s_shift_all</strong> (<em>dict of splines</em>) – each element k is the spline of frame k xy-aligned
on spline of frame k+1</p></li>
<li><p><strong>J</strong> (<em>int</em>) – number of window layers</p></li>
<li><p><strong>I</strong> (<em>list of int</em>) – number of windows per layer</p></li>
<li><p><strong>origins</strong> (<em>list of floats</em>) – each element k is the spline parameter shift to align
spline of frame k+1 on spine of frame k</p></li>
<li><p><strong>num_points</strong> (<em>int</em>) – number of interpolation points</p></li>
<li><p><strong>param</strong> (<em>Param object</em>) – As created by morphodyanmics.parameters.Param</p></li>
<li><p><strong>client</strong> (<em>dask client</em><em>, </em><em>optional</em>) – client connected to LocalCluster or SLURMCluster</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>t_all</strong> (<em>dict of 1d array</em>) – each element is a list of spline parameters defining closest locations
on s_all[t] to points defined by t0_all on s_all[t-1]</p></li>
<li><p><strong>t0_all</strong> (<em>1d array</em>) – each element is a list of spline paramters defining points centered on
windows of frame corresponding to s_all[t-1]</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="morphodynamics.analysis_par.windowing">
<span class="sig-prename descclassname"><span class="pre">morphodynamics.analysis_par.</span></span><span class="sig-name descname"><span class="pre">windowing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ori</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">J</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">I</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_iter</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.analysis_par.windowing" title="Permalink to this definition">¶</a></dt>
<dd><p>Create windowing for frame k_iter and save results.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>s</strong> (<em>tuple</em>) – spline object</p></li>
<li><p><strong>ori</strong> (<em>float</em>) – origin shift</p></li>
<li><p><strong>param</strong> (<em>Param object</em>) – As created by morphodyanmics.parameters.Param</p></li>
<li><p><strong>J</strong> (<em>int</em>) – number of window layers</p></li>
<li><p><strong>I</strong> (<em>list of int</em>) – number of windows per layer</p></li>
<li><p><strong>k_iter</strong> (<em>int</em>) – frame index</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="morphodynamics.analysis_par.windowing_all">
<span class="sig-prename descclassname"><span class="pre">morphodynamics.analysis_par.</span></span><span class="sig-name descname"><span class="pre">windowing_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s_all</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ori_all</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">J</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">I</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">client</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.analysis_par.windowing_all" title="Permalink to this definition">¶</a></dt>
<dd><p>Create windowing for all splines in s_all.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>s_all</strong> (<em>dict of spline objects</em>) – each element k of the dictionary contains the spline of the
corresponding frame k. The frame k-1 contains None</p></li>
<li><p><strong>ori_all</strong> (<em>list of floats</em>) – each element k is the spline parameter shift to align
spline of frame k+1 on spine of frame k</p></li>
<li><p><strong>param</strong> (<em>Param object</em>) – As created by morphodyanmics.parameters.Param</p></li>
<li><p><strong>J</strong> (<em>int</em>) – number of window layers</p></li>
<li><p><strong>I</strong> (<em>list of int</em>) – number of windows per layer</p></li>
<li><p><strong>client</strong> (<em>dask client</em><em>, </em><em>optional</em>) – client connected to LocalCluster or SLURMCluster</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-morphodynamics.correlation">
<span id="morphodynamics-correlation-module"></span><h2>morphodynamics.correlation module<a class="headerlink" href="#module-morphodynamics.correlation" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="morphodynamics.correlation.correlate">
<span class="sig-prename descclassname"><span class="pre">morphodynamics.correlation.</span></span><span class="sig-name descname"><span class="pre">correlate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalization</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">removemean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.correlation.correlate" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="morphodynamics.correlation.correlate_arrays">
<span class="sig-prename descclassname"><span class="pre">morphodynamics.correlation.</span></span><span class="sig-name descname"><span class="pre">correlate_arrays</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalization</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.correlation.correlate_arrays" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="morphodynamics.correlation.get_extent">
<span class="sig-prename descclassname"><span class="pre">morphodynamics.correlation.</span></span><span class="sig-name descname"><span class="pre">get_extent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">I</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.correlation.get_extent" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="morphodynamics.correlation.get_range">
<span class="sig-prename descclassname"><span class="pre">morphodynamics.correlation.</span></span><span class="sig-name descname"><span class="pre">get_range</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.correlation.get_range" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="morphodynamics.correlation.show_average_correlation">
<span class="sig-prename descclassname"><span class="pre">morphodynamics.correlation.</span></span><span class="sig-name descname"><span class="pre">show_average_correlation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.correlation.show_average_correlation" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="morphodynamics.correlation.show_correlation_core">
<span class="sig-prename descclassname"><span class="pre">morphodynamics.correlation.</span></span><span class="sig-name descname"><span class="pre">show_correlation_core</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ny</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalization</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.correlation.show_correlation_core" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot correlations between variables</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="morphodynamics.correlation.test_correlate">
<span class="sig-prename descclassname"><span class="pre">morphodynamics.correlation.</span></span><span class="sig-name descname"><span class="pre">test_correlate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.correlation.test_correlate" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-morphodynamics.displacementestimation">
<span id="morphodynamics-displacementestimation-module"></span><h2>morphodynamics.displacementestimation module<a class="headerlink" href="#module-morphodynamics.displacementestimation" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="morphodynamics.displacementestimation.align_curves">
<span class="sig-prename descclassname"><span class="pre">morphodynamics.displacementestimation.</span></span><span class="sig-name descname"><span class="pre">align_curves</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.displacementestimation.align_curves" title="Permalink to this definition">¶</a></dt>
<dd><p>This function is intended to help improve the accuracy of displacement estimation
when in addition to protrusions the cell is subject to motion.
The idea is to find a translation and a change of origin for s2 that aligns it
on s1.
The translated curve s1c essentially accounts for the the motion of the cell, and
once it is available, one can compute the usual displacement between s1c and s2.
The total displacement is the sum of both components.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>N</strong> (<em>int</em>) – Number of samples along the curve</p></li>
<li><p><strong>s1</strong> (<em>tuple</em>) – spline tuple as returned by splprep</p></li>
<li><p><strong>s2</strong> (<em>tuple</em>) – spline tuple as returned by splprep</p></li>
<li><p><strong>t1</strong> (<em>float</em>) – Origin of curve s1</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>s1c</strong> (<em>bspline tuple</em>) – translated curve s1 to match s2</p></li>
<li><p><strong>t2</strong> (<em>float</em>) – origin shift for s2 to match s1</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="morphodynamics.displacementestimation.correlate">
<span class="sig-prename descclassname"><span class="pre">morphodynamics.displacementestimation.</span></span><span class="sig-name descname"><span class="pre">correlate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.displacementestimation.correlate" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the correlation between two signals with periodic boundary conditions.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="morphodynamics.displacementestimation.find_origin">
<span class="sig-prename descclassname"><span class="pre">morphodynamics.displacementestimation.</span></span><span class="sig-name descname"><span class="pre">find_origin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.displacementestimation.find_origin" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the parameter for s2 that best approximates the origin on s1
given a shift t0.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>N</strong> (<em>int</em>) – Number of samples along the curve</p></li>
<li><p><strong>s1</strong> (<em>tuple</em>) – spline tuple as returned by splprep</p></li>
<li><p><strong>s2</strong> (<em>tuple</em>) – spline tuple as returned by splprep</p></li>
<li><p><strong>t0</strong> (<em>float</em>) – Origin shift of curve s1</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>orig_param</strong> – parameter for s2 matching origin position on s1</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="morphodynamics.displacementestimation.map_contours">
<span class="sig-prename descclassname"><span class="pre">morphodynamics.displacementestimation.</span></span><span class="sig-name descname"><span class="pre">map_contours</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.displacementestimation.map_contours" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute displacement vectors between two consecutive contours.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="morphodynamics.displacementestimation.map_contours2">
<span class="sig-prename descclassname"><span class="pre">morphodynamics.displacementestimation.</span></span><span class="sig-name descname"><span class="pre">map_contours2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.displacementestimation.map_contours2" title="Permalink to this definition">¶</a></dt>
<dd><p>Solves a variational problem for mapping positions along contour s1
to positions along contour s2.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>s1</strong> (<em>tuple</em>) – spline tuple as returned by splprep</p></li>
<li><p><strong>s2</strong> (<em>tuple</em>) – spline tuple as returned by splprep</p></li>
<li><p><strong>t1</strong> (<em>1d array</em>) – list of spline parameters along s1
defining positions centered on windows</p></li>
<li><p><strong>t2</strong> (<em>1d array</em>) – list of spline parameters along s2
as initial guesses</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>t2</strong> – updated positions along s2 minimizing the functional</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>1d array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="morphodynamics.displacementestimation.map_contours3">
<span class="sig-prename descclassname"><span class="pre">morphodynamics.displacementestimation.</span></span><span class="sig-name descname"><span class="pre">map_contours3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.displacementestimation.map_contours3" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-morphodynamics.folders">
<span id="morphodynamics-folders-module"></span><h2>morphodynamics.folders module<a class="headerlink" href="#module-morphodynamics.folders" title="Permalink to this headline">¶</a></h2>
<p>Class implementing a simple file browser for Jupyter</p>
<dl class="py class">
<dt class="sig sig-object py" id="morphodynamics.folders.Folders">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">morphodynamics.folders.</span></span><span class="sig-name descname"><span class="pre">Folders</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rows</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.folders.Folders" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="morphodynamics.folders.Folders.get_files">
<span class="sig-name descname"><span class="pre">get_files</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.folders.Folders.get_files" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="morphodynamics.folders.Folders.go_to_folder">
<span class="sig-name descname"><span class="pre">go_to_folder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">folder</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.folders.Folders.go_to_folder" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="morphodynamics.folders.Folders.move_folders">
<span class="sig-name descname"><span class="pre">move_folders</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">change</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.folders.Folders.move_folders" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="morphodynamics.folders.Folders.refresh">
<span class="sig-name descname"><span class="pre">refresh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.folders.Folders.refresh" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-morphodynamics.functionaldefinition">
<span id="morphodynamics-functionaldefinition-module"></span><h2>morphodynamics.functionaldefinition module<a class="headerlink" href="#module-morphodynamics.functionaldefinition" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="morphodynamics.functionaldefinition.Functional">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">morphodynamics.functionaldefinition.</span></span><span class="sig-name descname"><span class="pre">Functional</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tck1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tck2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.functionaldefinition.Functional" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="morphodynamics.functionaldefinition.Functional.f">
<span class="sig-name descname"><span class="pre">f</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.functionaldefinition.Functional.f" title="Permalink to this definition">¶</a></dt>
<dd><p>The functional to be minimized, adapted from the following paper:
Ma Dagliyan Hahn Danuser - Profiling cellular morphodynamics by spatiotemporal spectrum decomposition
Note that here periodic boundary conditions are enforced.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="morphodynamics.functionaldefinition.Functional.inversetransform">
<span class="sig-name descname"><span class="pre">inversetransform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.functionaldefinition.Functional.inversetransform" title="Permalink to this definition">¶</a></dt>
<dd><p>Inverse of the change of variable.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="morphodynamics.functionaldefinition.Functional.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">o</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.functionaldefinition.Functional.transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Change of variable that is necessary to express the constraints of the optimization problem as simple inequalities.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="morphodynamics.functionaldefinition.Functional2">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">morphodynamics.functionaldefinition.</span></span><span class="sig-name descname"><span class="pre">Functional2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tck1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tck2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.functionaldefinition.Functional2" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="morphodynamics.functionaldefinition.Functional2.f">
<span class="sig-name descname"><span class="pre">f</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.functionaldefinition.Functional2.f" title="Permalink to this definition">¶</a></dt>
<dd><p>The functional to be minimized, adapted from the following paper:
Ma Dagliyan Hahn Danuser - Profiling cellular morphodynamics by spatiotemporal spectrum decomposition
Note that here periodic boundary conditions are enforced.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="morphodynamics.functionaldefinition.Functional3">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">morphodynamics.functionaldefinition.</span></span><span class="sig-name descname"><span class="pre">Functional3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tck1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tck2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.functionaldefinition.Functional3" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="morphodynamics.functionaldefinition.Functional3.f">
<span class="sig-name descname"><span class="pre">f</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.functionaldefinition.Functional3.f" title="Permalink to this definition">¶</a></dt>
<dd><p>The functional to be minimized, adapted from the following paper:
Ma Dagliyan Hahn Danuser - Profiling cellular morphodynamics by spatiotemporal spectrum decomposition
Note that here periodic boundary conditions are enforced.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-morphodynamics.morpho_segmentation">
<span id="morphodynamics-morpho-segmentation-module"></span><h2>morphodynamics.morpho_segmentation module<a class="headerlink" href="#module-morphodynamics.morpho_segmentation" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="morphodynamics.morpho_segmentation.InteractSeg">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">morphodynamics.morpho_segmentation.</span></span><span class="sig-name descname"><span class="pre">InteractSeg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_folder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">analysis_folder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seg_folder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seg_channel_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signal_channel_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'2</span> <span class="pre">GB'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cores</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_trackseg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seg_algo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ilastik'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_createUI</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.morpho_segmentation.InteractSeg" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Methods creating the user interface for the package.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_folder</strong> (<em>str</em>) – path to folder containing data</p></li>
<li><p><strong>analysis_folder</strong> (<em>str</em>) – path to folder where to save data</p></li>
<li><p><strong>seg_folder</strong> (<em>str</em>) – path to folder where to save segmentation results</p></li>
<li><p><strong>seg_channel_name</strong> (<em>str</em>) – name of folder or file used segmentation</p></li>
<li><p><strong>signal_channel_names</strong> (<em>list of str</em>) – names of folders or files used as signal</p></li>
<li><p><strong>memory</strong> (<em>str</em>) – RAM to use on cluster</p></li>
<li><p><strong>cores</strong> (<em>int</em>) – number of cores to use per worker</p></li>
<li><p><strong>skip_trackseg</strong> (<em>bool</em>) – skip segmentation and tracking (only possible
if done previously)</p></li>
<li><p><strong>seg_algo</strong> (<em>str</em>) – type of segmentation algorithm to use
can be “fardi”, “cellpose” or “ilastik”</p></li>
<li><p><strong>do_createUI</strong> (<em>bool</em>) – create or not a UI</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">data_folder,</span> <span class="pre">memory,</span> <span class="pre">cores</span></span></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>see Parameters</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="morphodynamics.morpho_segmentation.InteractSeg.create_ui_options">
<span class="sig-name descname"><span class="pre">create_ui_options</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.morpho_segmentation.InteractSeg.create_ui_options" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="morphodynamics.morpho_segmentation.InteractSeg.export_data">
<span class="sig-name descname"><span class="pre">export_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.morpho_segmentation.InteractSeg.export_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Callback to export Results and Parameters</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="morphodynamics.morpho_segmentation.InteractSeg.get_folders">
<span class="sig-name descname"><span class="pre">get_folders</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">change</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.morpho_segmentation.InteractSeg.get_folders" title="Permalink to this definition">¶</a></dt>
<dd><p>Update channel options when selecting new main folder</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="morphodynamics.morpho_segmentation.InteractSeg.initialize">
<span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.morpho_segmentation.InteractSeg.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a data object based on chosen directories/files</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="morphodynamics.morpho_segmentation.InteractSeg.initialize_dask">
<span class="sig-name descname"><span class="pre">initialize_dask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">change</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.morpho_segmentation.InteractSeg.initialize_dask" title="Permalink to this definition">¶</a></dt>
<dd><p>If dask is used, start it and display UI.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="morphodynamics.morpho_segmentation.InteractSeg.load_data">
<span class="sig-name descname"><span class="pre">load_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.morpho_segmentation.InteractSeg.load_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Callback to load params, data and results</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="morphodynamics.morpho_segmentation.InteractSeg.load_params">
<span class="sig-name descname"><span class="pre">load_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.morpho_segmentation.InteractSeg.load_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Callback to load only params and data</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="morphodynamics.morpho_segmentation.InteractSeg.on_key_press">
<span class="sig-name descname"><span class="pre">on_key_press</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">event</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.morpho_segmentation.InteractSeg.on_key_press" title="Permalink to this definition">¶</a></dt>
<dd><p>Record if shift key is pressed</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="morphodynamics.morpho_segmentation.InteractSeg.on_key_release">
<span class="sig-name descname"><span class="pre">on_key_release</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">event</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.morpho_segmentation.InteractSeg.on_key_release" title="Permalink to this definition">¶</a></dt>
<dd><p>Record if shift key is released</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="morphodynamics.morpho_segmentation.InteractSeg.run_segmentation">
<span class="sig-name descname"><span class="pre">run_segmentation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.morpho_segmentation.InteractSeg.run_segmentation" title="Permalink to this definition">¶</a></dt>
<dd><p>Run segmentation analysis</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="morphodynamics.morpho_segmentation.InteractSeg.ui">
<span class="sig-name descname"><span class="pre">ui</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">change</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.morpho_segmentation.InteractSeg.ui" title="Permalink to this definition">¶</a></dt>
<dd><p>Create interface</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="morphodynamics.morpho_segmentation.InteractSeg.ui_folder_panel">
<span class="sig-name descname"><span class="pre">ui_folder_panel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">work_type</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.morpho_segmentation.InteractSeg.ui_folder_panel" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="morphodynamics.morpho_segmentation.InteractSeg.update_display_channel">
<span class="sig-name descname"><span class="pre">update_display_channel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">change</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.morpho_segmentation.InteractSeg.update_display_channel" title="Permalink to this definition">¶</a></dt>
<dd><p>Callback to update displayed channel</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="morphodynamics.morpho_segmentation.InteractSeg.update_display_channel_list">
<span class="sig-name descname"><span class="pre">update_display_channel_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">change</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.morpho_segmentation.InteractSeg.update_display_channel_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Callback to update available channels to display</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="morphodynamics.morpho_segmentation.InteractSeg.update_interface">
<span class="sig-name descname"><span class="pre">update_interface</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">param_copy</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.morpho_segmentation.InteractSeg.update_interface" title="Permalink to this definition">¶</a></dt>
<dd><p>Set interface parameters using information from param object</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="morphodynamics.morpho_segmentation.InteractSeg.update_location">
<span class="sig-name descname"><span class="pre">update_location</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">change</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.morpho_segmentation.InteractSeg.update_location" title="Permalink to this definition">¶</a></dt>
<dd><p>Callback to update cm location after manual location entering</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="morphodynamics.morpho_segmentation.InteractSeg.update_param_analysis_folder">
<span class="sig-name descname"><span class="pre">update_param_analysis_folder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">change</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.morpho_segmentation.InteractSeg.update_param_analysis_folder" title="Permalink to this definition">¶</a></dt>
<dd><p>Callback to update saving directory paramters</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="morphodynamics.morpho_segmentation.InteractSeg.update_param_bad_frames">
<span class="sig-name descname"><span class="pre">update_param_bad_frames</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">change</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.morpho_segmentation.InteractSeg.update_param_bad_frames" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="morphodynamics.morpho_segmentation.InteractSeg.update_param_data_folder">
<span class="sig-name descname"><span class="pre">update_param_data_folder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">change</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.morpho_segmentation.InteractSeg.update_param_data_folder" title="Permalink to this definition">¶</a></dt>
<dd><p>Callback to update saving directory paramters</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="morphodynamics.morpho_segmentation.InteractSeg.update_param_max_time">
<span class="sig-name descname"><span class="pre">update_param_max_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">change</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.morpho_segmentation.InteractSeg.update_param_max_time" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="morphodynamics.morpho_segmentation.InteractSeg.update_param_morpho_name">
<span class="sig-name descname"><span class="pre">update_param_morpho_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">change</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.morpho_segmentation.InteractSeg.update_param_morpho_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Calback to update segmentation file lists depending on selections</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="morphodynamics.morpho_segmentation.InteractSeg.update_param_seg_algo">
<span class="sig-name descname"><span class="pre">update_param_seg_algo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">change</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.morpho_segmentation.InteractSeg.update_param_seg_algo" title="Permalink to this definition">¶</a></dt>
<dd><p>Callback to update saving directory paramters</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="morphodynamics.morpho_segmentation.InteractSeg.update_param_seg_folder">
<span class="sig-name descname"><span class="pre">update_param_seg_folder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">change</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.morpho_segmentation.InteractSeg.update_param_seg_folder" title="Permalink to this definition">¶</a></dt>
<dd><p>Callback to update saving directory paramters</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="morphodynamics.morpho_segmentation.InteractSeg.update_param_signal_name">
<span class="sig-name descname"><span class="pre">update_param_signal_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">change</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.morpho_segmentation.InteractSeg.update_param_signal_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Calback to update signal file lists depending on selections</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="morphodynamics.morpho_segmentation.InteractSeg.update_param_simple">
<span class="sig-name descname"><span class="pre">update_param_simple</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">change</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.morpho_segmentation.InteractSeg.update_param_simple" title="Permalink to this definition">¶</a></dt>
<dd><p>Calback to update segmentation file lists depending on selections</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="morphodynamics.morpho_segmentation.InteractSeg.windows_for_plot">
<span class="sig-name descname"><span class="pre">windows_for_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">im_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.morpho_segmentation.InteractSeg.windows_for_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a window image</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-morphodynamics.segmentation">
<span id="morphodynamics-segmentation-module"></span><h2>morphodynamics.segmentation module<a class="headerlink" href="#module-morphodynamics.segmentation" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="morphodynamics.segmentation.contour_spline">
<span class="sig-prename descclassname"><span class="pre">morphodynamics.segmentation.</span></span><span class="sig-name descname"><span class="pre">contour_spline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smoothing</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.segmentation.contour_spline" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract contour from binary image and fit a spline</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>2d array</em>) – binary image</p></li>
<li><p><strong>smoothing</strong> (<em>float</em>) – smoothing parameter as defined by splprep</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>s</strong> (<em>spline tuple</em>)</p></li>
<li><p><strong>c</strong> (<em>2d array</em>) – coordinates of contour</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="morphodynamics.segmentation.estimateBleaching">
<span class="sig-prename descclassname"><span class="pre">morphodynamics.segmentation.</span></span><span class="sig-name descname"><span class="pre">estimateBleaching</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">K</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.segmentation.estimateBleaching" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimate the intensity decay due to bleaching.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="morphodynamics.segmentation.extract_contour">
<span class="sig-prename descclassname"><span class="pre">morphodynamics.segmentation.</span></span><span class="sig-name descname"><span class="pre">extract_contour</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mask</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.segmentation.extract_contour" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract pixels along contour of mask.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="morphodynamics.segmentation.segment_cellpose">
<span class="sig-prename descclassname"><span class="pre">morphodynamics.segmentation.</span></span><span class="sig-name descname"><span class="pre">segment_cellpose</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diameter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">location</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.segmentation.segment_cellpose" title="Permalink to this definition">¶</a></dt>
<dd><p>Segment image x using Cellpose. If model is None, a model is loaded</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="morphodynamics.segmentation.segment_conv_paint">
<span class="sig-prename descclassname"><span class="pre">morphodynamics.segmentation.</span></span><span class="sig-name descname"><span class="pre">segment_conv_paint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_forest</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.segmentation.segment_conv_paint" title="Permalink to this definition">¶</a></dt>
<dd><p>Segment image x using a trained classifier and
the conv paint module.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="morphodynamics.segmentation.segment_farid">
<span class="sig-prename descclassname"><span class="pre">morphodynamics.segmentation.</span></span><span class="sig-name descname"><span class="pre">segment_farid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.segmentation.segment_farid" title="Permalink to this definition">¶</a></dt>
<dd><p>Segment an image using its gradient calculated using
the Farid method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>2d array</em>) – image to segment</p></li>
<li><p><strong>threshold</strong> (<em>float</em>) – threshold on gradient image</p></li>
<li><p><strong>minsize</strong> (<em>int</em>) – remove binary objects smaller than this value</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>regions</strong> – labelled array</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>2d array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="morphodynamics.segmentation.segment_threshold">
<span class="sig-prename descclassname"><span class="pre">morphodynamics.segmentation.</span></span><span class="sig-name descname"><span class="pre">segment_threshold</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.segmentation.segment_threshold" title="Permalink to this definition">¶</a></dt>
<dd><p>Segment the cell image, possibly with automatic threshold selection.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="morphodynamics.segmentation.tracking">
<span class="sig-prename descclassname"><span class="pre">morphodynamics.segmentation.</span></span><span class="sig-name descname"><span class="pre">tracking</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">regions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">location</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seg_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'farid'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.segmentation.tracking" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a labelled mask, select one of the objects as cell.
If a location is provided, pick closest object, otherwise
pick largest.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>regions</strong> (<em>2d array</em>) – labeled mask of cells</p></li>
<li><p><strong>location</strong> (<em>1d array</em><em>, </em><em>optional</em>) – position vector</p></li>
<li><p><strong>seg_type</strong> (<em>str</em>) – type of segmentation used, currently ‘farid’, ‘cellpose’, ‘ilastik’ or ‘conv_paint’</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>sel_region</strong> – binary mask of cell</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>2d array</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-morphodynamics.splineutils">
<span id="morphodynamics-splineutils-module"></span><h2>morphodynamics.splineutils module<a class="headerlink" href="#module-morphodynamics.splineutils" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="morphodynamics.splineutils.colour_image_border_by_feature">
<span class="sig-prename descclassname"><span class="pre">morphodynamics.splineutils.</span></span><span class="sig-name descname"><span class="pre">colour_image_border_by_feature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">im_contour_bw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_param</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.splineutils.colour_image_border_by_feature" title="Permalink to this definition">¶</a></dt>
<dd><p>Given an image of a contour colored by distance along contour,
color the border of the image by the feature.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>im_contour_bw</strong> (<em>ndarray</em>) – image of contour</p></li>
<li><p><strong>t_param</strong> (<em>array</em>) – parametric points along contour [0,1] of length N</p></li>
<li><p><strong>feature</strong> (<em>array</em>) – variable to be used for colouring the border of length N
feature[i] is the value of the feature at t_param[i]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>image of contour colored by feature</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>im_contour_bw</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="morphodynamics.splineutils.edge_colored_by_features">
<span class="sig-prename descclassname"><span class="pre">morphodynamics.splineutils.</span></span><span class="sig-name descname"><span class="pre">edge_colored_by_features</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enlarge_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.splineutils.edge_colored_by_features" title="Permalink to this definition">¶</a></dt>
<dd><p>Create gray-scale image of contour where pixel values are interpolated
according to the feature.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>data object</em>) – </p></li>
<li><p><strong>res</strong> (<em>result object</em>) – </p></li>
<li><p><strong>t</strong> (<em>int</em>) – frame</p></li>
<li><p><strong>feature</strong> (<em>str</em>) – feature for coloring ‘displacement’, ‘displacement_cumul’, ‘curvature’</p></li>
<li><p><strong>N</strong> (<em>int</em>) – number of points for contour generation, default None</p></li>
<li><p><strong>enlarge_width</strong> (<em>int</em><em>, </em><em>optional</em>) – width of contour for display, by default 1</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>colored image (gray-scale) and mask of (wide) contour pixels</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>im_coloured, mask</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="morphodynamics.splineutils.enlarge_contour">
<span class="sig-prename descclassname"><span class="pre">morphodynamics.splineutils.</span></span><span class="sig-name descname"><span class="pre">enlarge_contour</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">im_contour</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thickness</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.splineutils.enlarge_contour" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a single pixel gray-scale contour, expand it to give it
a thickness.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>im_contour</strong> (<em>ndarray</em>) – image of contour</p></li>
<li><p><strong>mask</strong> (<em>ndarray</em>) – maks of contour</p></li>
<li><p><strong>thickness</strong> (<em>int</em>) – desired contour thickness</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>image of enlarged contour and its mask</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>im_contour, mask</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="morphodynamics.splineutils.fit_spline">
<span class="sig-prename descclassname"><span class="pre">morphodynamics.splineutils.</span></span><span class="sig-name descname"><span class="pre">fit_spline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lambda_</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.splineutils.fit_spline" title="Permalink to this definition">¶</a></dt>
<dd><p>”
Fit a spline to a contour specified as a list of pixels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>c</strong> (<em>2d array</em>) – contour coordinates</p></li>
<li><p><strong>lambda</strong> (<em>float</em>) – smoothing parameter (as used by splprep)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>s</strong> – spline tuple</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="morphodynamics.splineutils.splevper">
<span class="sig-prename descclassname"><span class="pre">morphodynamics.splineutils.</span></span><span class="sig-name descname"><span class="pre">splevper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s_tuple</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.splineutils.splevper" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate B-spline for periodic curve</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>1d array</em>) – points on which to return the evaluation</p></li>
<li><p><strong>s_tuple</strong> (<em>spline tuple as returned by splprep</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>coordinates of evaluated spline</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of arrays</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="morphodynamics.splineutils.spline_area">
<span class="sig-prename descclassname"><span class="pre">morphodynamics.splineutils.</span></span><span class="sig-name descname"><span class="pre">spline_area</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s_tuple</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.splineutils.spline_area" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute area of spline s discretized in N segments.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="morphodynamics.splineutils.spline_contour_length">
<span class="sig-prename descclassname"><span class="pre">morphodynamics.splineutils.</span></span><span class="sig-name descname"><span class="pre">spline_contour_length</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s_tuple</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.splineutils.spline_contour_length" title="Permalink to this definition">¶</a></dt>
<dd><p>Get spline contour length between params t1 and t2</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t1</strong> (<em>float</em>) – parameter limits</p></li>
<li><p><strong>t2</strong> (<em>float</em>) – parameter limits</p></li>
<li><p><strong>N</strong> (<em>int</em>) – number of points on the contour</p></li>
<li><p><strong>s</strong> (<em>tuple</em>) – spline tuple as returned by splprep</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>spline_length</strong> – contour length of spline</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="morphodynamics.splineutils.spline_curvature">
<span class="sig-prename descclassname"><span class="pre">morphodynamics.splineutils.</span></span><span class="sig-name descname"><span class="pre">spline_curvature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s_tuple</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.splineutils.spline_curvature" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute local curvature of spline s at paramters positions t.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="morphodynamics.splineutils.spline_int_coordinates">
<span class="sig-prename descclassname"><span class="pre">morphodynamics.splineutils.</span></span><span class="sig-name descname"><span class="pre">spline_int_coordinates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.splineutils.spline_int_coordinates" title="Permalink to this definition">¶</a></dt>
<dd><p>Get integer xy coordinates of a spline.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>N</strong> (<em>int</em>) – number of points on the contour</p></li>
<li><p><strong>s</strong> (<em>tuple</em>) – spline tuple as returned by splprep</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>spline_int_xy</strong> – coordinates of spline</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>2d array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="morphodynamics.splineutils.spline_to_binary_image">
<span class="sig-prename descclassname"><span class="pre">morphodynamics.splineutils.</span></span><span class="sig-name descname"><span class="pre">spline_to_binary_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">im_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.splineutils.spline_to_binary_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Turn a spline into a binary image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>N</strong> (<em>int</em>) – number of points on the contour</p></li>
<li><p><strong>im_shape</strong> (<em>tuple</em>) – size of the desired image.</p></li>
<li><p><strong>s</strong> (<em>tuple</em>) – spline tuple as returned by splprep</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>im_spline</strong> – rasterized image of the contour</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>2d array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="morphodynamics.splineutils.spline_to_param_image">
<span class="sig-prename descclassname"><span class="pre">morphodynamics.splineutils.</span></span><span class="sig-name descname"><span class="pre">spline_to_param_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">im_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deltat</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.splineutils.spline_to_param_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Represent a contour as a grayscale image.
If a pixel is part of the contour, then its intensity
is equal to the parameter t of the closest point on the contour s(t).
Otherwise it is equal to -1.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>N</strong> (<em>int</em>) – number of points on the contour</p></li>
<li><p><strong>im_shape</strong> (<em>tuple</em>) – size of the desired image.</p></li>
<li><p><strong>s</strong> (<em>tuple</em>) – spline tuple as returned by splprep</p></li>
<li><p><strong>deltat</strong> (<em>float</em>) – origin shift of the spline.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>tau</strong> – rasterized image of the contour</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>2d array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="morphodynamics.splineutils.subdivide_curve">
<span class="sig-prename descclassname"><span class="pre">morphodynamics.splineutils.</span></span><span class="sig-name descname"><span class="pre">subdivide_curve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">I</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.splineutils.subdivide_curve" title="Permalink to this definition">¶</a></dt>
<dd><p>Define points on a contour that are equispaced with respect to the arc length.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>N</strong> (<em>int</em>) – number of points for spline discretization</p></li>
<li><p><strong>s</strong> (<em>tuple</em>) – spline tuple as returned by splprep</p></li>
<li><p><strong>origin</strong> (<em>float</em>) – shift of parameter origin</p></li>
<li><p><strong>I</strong> (<em>int</em>) – Number of windows in the first (outer) layer.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>t_shifted</strong> – list of spline parameters on s defining the same points as cvec_sel</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>1d array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="morphodynamics.splineutils.subdivide_curve_discrete">
<span class="sig-prename descclassname"><span class="pre">morphodynamics.splineutils.</span></span><span class="sig-name descname"><span class="pre">subdivide_curve_discrete</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_main</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">I</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">origin</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.splineutils.subdivide_curve_discrete" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a discrete contour whose first pixel corresponds
to the specified origin, plus a list of coordinates along the
continuous curve corresponding to the mid-points of the
windows in the first (outer) layer.</p>
<p>Note: this function tries to reconcile discrete and continuous
representations of the contour, so it may not be conceptually
very satisfactory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>N</strong> (<em>int</em>) – number of points for spline discretization</p></li>
<li><p><strong>c_main</strong> (<em>2d array</em>) – A rasterized version of the contour, as obtained by rasterize_curve.</p></li>
<li><p><strong>I</strong> (<em>int</em>) – Number of windows in the first (outer) layer.</p></li>
<li><p><strong>s</strong> (<em>tuple</em>) – spline tuple as returned by splprep</p></li>
<li><p><strong>origin</strong> (<em>ndarray</em>) – [y, x] coordinates of the origin of the curve.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>cvec_sel</strong> (<em>2d array</em>) – xy array of selected positions along the contour</p></li>
<li><p><strong>t_sel</strong> (<em>1d array</em>) – list of spline parameters on s defining the same points as cvec_sel</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-morphodynamics.syntheticdata">
<span id="morphodynamics-syntheticdata-module"></span><h2>morphodynamics.syntheticdata module<a class="headerlink" href="#module-morphodynamics.syntheticdata" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="morphodynamics.syntheticdata.largeTurningEllipse">
<span class="sig-prename descclassname"><span class="pre">morphodynamics.syntheticdata.</span></span><span class="sig-name descname"><span class="pre">largeTurningEllipse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.syntheticdata.largeTurningEllipse" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="morphodynamics.syntheticdata.main">
<span class="sig-prename descclassname"><span class="pre">morphodynamics.syntheticdata.</span></span><span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.syntheticdata.main" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="morphodynamics.syntheticdata.movingEllipse">
<span class="sig-prename descclassname"><span class="pre">morphodynamics.syntheticdata.</span></span><span class="sig-name descname"><span class="pre">movingEllipse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.syntheticdata.movingEllipse" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="morphodynamics.syntheticdata.protrudingEllipse">
<span class="sig-prename descclassname"><span class="pre">morphodynamics.syntheticdata.</span></span><span class="sig-name descname"><span class="pre">protrudingEllipse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.syntheticdata.protrudingEllipse" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="morphodynamics.syntheticdata.pumpingDisk">
<span class="sig-prename descclassname"><span class="pre">morphodynamics.syntheticdata.</span></span><span class="sig-name descname"><span class="pre">pumpingDisk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.syntheticdata.pumpingDisk" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="morphodynamics.syntheticdata.pumpingEllipse">
<span class="sig-prename descclassname"><span class="pre">morphodynamics.syntheticdata.</span></span><span class="sig-name descname"><span class="pre">pumpingEllipse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.syntheticdata.pumpingEllipse" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="morphodynamics.syntheticdata.signalEllipse">
<span class="sig-prename descclassname"><span class="pre">morphodynamics.syntheticdata.</span></span><span class="sig-name descname"><span class="pre">signalEllipse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.syntheticdata.signalEllipse" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="morphodynamics.syntheticdata.tri">
<span class="sig-prename descclassname"><span class="pre">morphodynamics.syntheticdata.</span></span><span class="sig-name descname"><span class="pre">tri</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.syntheticdata.tri" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="morphodynamics.syntheticdata.turningEllipse">
<span class="sig-prename descclassname"><span class="pre">morphodynamics.syntheticdata.</span></span><span class="sig-name descname"><span class="pre">turningEllipse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.syntheticdata.turningEllipse" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="morphodynamics.syntheticdata.turningSquare">
<span class="sig-prename descclassname"><span class="pre">morphodynamics.syntheticdata.</span></span><span class="sig-name descname"><span class="pre">turningSquare</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.syntheticdata.turningSquare" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="morphodynamics.syntheticdata.walkingRectangles">
<span class="sig-prename descclassname"><span class="pre">morphodynamics.syntheticdata.</span></span><span class="sig-name descname"><span class="pre">walkingRectangles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.syntheticdata.walkingRectangles" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-morphodynamics.utils">
<span id="morphodynamics-utils-module"></span><h2>morphodynamics.utils module<a class="headerlink" href="#module-morphodynamics.utils" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="morphodynamics.utils.dataset_from_param">
<span class="sig-prename descclassname"><span class="pre">morphodynamics.utils.</span></span><span class="sig-name descname"><span class="pre">dataset_from_param</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">param</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.utils.dataset_from_param" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a param object, create the appropriate dataset.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="morphodynamics.utils.export_results_parameters">
<span class="sig-prename descclassname"><span class="pre">morphodynamics.utils.</span></span><span class="sig-name descname"><span class="pre">export_results_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">param</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.utils.export_results_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Export parameters and results</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="morphodynamics.utils.format_bad_frames">
<span class="sig-prename descclassname"><span class="pre">morphodynamics.utils.</span></span><span class="sig-name descname"><span class="pre">format_bad_frames</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bad_frames</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.utils.format_bad_frames" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an array of bad frame indices from string loaded from yml file.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="morphodynamics.utils.load_alldata">
<span class="sig-prename descclassname"><span class="pre">morphodynamics.utils.</span></span><span class="sig-name descname"><span class="pre">load_alldata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">folder_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">load_results</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.utils.load_alldata" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a folder, load the parameter information contained in
Parameters.yml and optionally load results from the
Results.yml file. If a Param object is given, it is not loaded
again.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>folder_path</strong> (<em>str</em>) – Path to folder containing Parameters.yml file</p></li>
<li><p><strong>load_results</strong> (<em>bool</em><em> (</em><em>False</em><em>)</em>) – Load results from Results.yml file or not</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>param</strong> (<em>Param object</em>) – As created by morphodynamics.parameters.Param</p></li>
<li><p><strong>res</strong> (<em>Result object</em>) – As created by morphodynamics.results.Results</p></li>
<li><p><strong>data</strong> (<em>Data object</em>) – As created by morphodynamics.dataset</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="morphodynamics.utils.load_rasterized">
<span class="sig-prename descclassname"><span class="pre">morphodynamics.utils.</span></span><span class="sig-name descname"><span class="pre">load_rasterized</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">location</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.utils.load_rasterized" title="Permalink to this definition">¶</a></dt>
<dd><p>Load rasterized contour image at given frame</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="morphodynamics.utils.load_window_image">
<span class="sig-prename descclassname"><span class="pre">morphodynamics.utils.</span></span><span class="sig-name descname"><span class="pre">load_window_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">location</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.utils.load_window_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Load rasterized contour image at given frame</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="morphodynamics.utils.signalarray_to_dataframe">
<span class="sig-prename descclassname"><span class="pre">morphodynamics.utils.</span></span><span class="sig-name descname"><span class="pre">signalarray_to_dataframe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">signal_dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.utils.signalarray_to_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>Turn a signal array with channel, layer, window, time dimensions
into Dataframe</p>
</dd></dl>

</div>
<div class="section" id="module-morphodynamics.windowing">
<span id="morphodynamics-windowing-module"></span><h2>morphodynamics.windowing module<a class="headerlink" href="#module-morphodynamics.windowing" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="morphodynamics.windowing.boundaries_image">
<span class="sig-prename descclassname"><span class="pre">morphodynamics.windowing.</span></span><span class="sig-name descname"><span class="pre">boundaries_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">im_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.windowing.boundaries_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Create array where windows boundaries are set to 1 and
the background to nan</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>im_shape</strong> (<em>tuple</em>) – size of image to produce</p></li>
<li><p><strong>window</strong> (<em>3d list</em>) – window indices list as produced by create_windows()</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="morphodynamics.windowing.calculate_windows_index">
<span class="sig-prename descclassname"><span class="pre">morphodynamics.windowing.</span></span><span class="sig-name descname"><span class="pre">calculate_windows_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.windowing.calculate_windows_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate per window index position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>w</strong> (<em>3d list</em>) – list of window indices as output by create_windows()</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>windows_pos</strong> – each element is a list [x, y, index] where x,y are the
window average position</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of lists</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="morphodynamics.windowing.compute_discrete_arc_length">
<span class="sig-prename descclassname"><span class="pre">morphodynamics.windowing.</span></span><span class="sig-name descname"><span class="pre">compute_discrete_arc_length</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.windowing.compute_discrete_arc_length" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute cumulative arc length along contour c.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>c</strong> (<em>2d array</em>) – list of contour coordinates</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>L</strong> – arc length along contour</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>1d array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="morphodynamics.windowing.create_arc_length_image">
<span class="sig-prename descclassname"><span class="pre">morphodynamics.windowing.</span></span><span class="sig-name descname"><span class="pre">create_arc_length_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">L</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.windowing.create_arc_length_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Create image of cumulative arc length by assigning cumulative length to
pixels along contour.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> (<em>tuple</em>) – intended shape of image</p></li>
<li><p><strong>c</strong> (<em>2d array</em>) – contour coordinates</p></li>
<li><p><strong>L</strong> (<em>2d array</em>) – arc length along contour</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="morphodynamics.windowing.create_windows">
<span class="sig-prename descclassname"><span class="pre">morphodynamics.windowing.</span></span><span class="sig-name descname"><span class="pre">create_windows</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c_main</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">origin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">J</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">I</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.windowing.create_windows" title="Permalink to this definition">¶</a></dt>
<dd><p>Create windows based on contour and windowing parameters. The first
window (at arc length = 0) is placed at the spline origin.</p>
<p>Note: to define the windows, this function uses pseudo-radial and
pseudo-angular coordinates. The pseudo-radial coordinate is based
on the distance transform of the rasterized version of the continuous
spline that defines the contour of the cell. The pseudo-angular coordinate
for layer j is based on the distance transform of the discrete contour of
layer j. So there is a bit of an inconsistency between continuous and
discrete contours.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>c_main</strong> (<em>2d array</em>) – A rasterized version of the contour, as obtained
by spline_to_param_image.</p></li>
<li><p><strong>origin</strong> (<em>tuple</em>) – (y, x) coordinates of the origin of the curve.</p></li>
<li><p><strong>J</strong> (<em>int</em>) – Number of window layers.</p></li>
<li><p><strong>I</strong> (<em>list of int</em>) – Vector of dimension J specifying the number of windows per layer.</p></li>
<li><p><strong>depth</strong> (<em>int</em>) – Desired depth of the windows.</p></li>
<li><p><strong>width</strong> (<em>int</em>) – Desired width of the windows.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>w</strong> (<em>3d list</em>) – w[i][j][0] and w[i][j][1] are 1d arrays representing
lists of x,y indices of pixels belonging to window in i’th layer
in j’th window</p></li>
<li><p><strong>J</strong> (<em>int</em>) – number of layers (calculated if not provided as input)</p></li>
<li><p><strong>I</strong> (<em>list of int</em>) – number of windows per layer (calculated if not provided as input)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="morphodynamics.windowing.extract_signals">
<span class="sig-prename descclassname"><span class="pre">morphodynamics.windowing.</span></span><span class="sig-name descname"><span class="pre">extract_signals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.windowing.extract_signals" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract the mean and variance of an image over the sampling windows.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y</strong> (<em>2d array</em><em>, </em><em>Image</em>) – </p></li>
<li><p><strong>w</strong> (<em>3d list</em>) – list of window indices as output by create_windows()</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>mean</strong> (<em>2d array</em>) – mean values of signal in each window. Array of size number of
layers times number of windows in outer layer</p></li>
<li><p><strong>var</strong> (<em>2d array</em>) – variance values of signal in each window. Array of size number of
layers times number of windows in outer layer</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="morphodynamics.windowing.label_windows">
<span class="sig-prename descclassname"><span class="pre">morphodynamics.windowing.</span></span><span class="sig-name descname"><span class="pre">label_windows</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">windows</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.windowing.label_windows" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an image where the sampling windows are shown as regions
with unique gray levels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> (<em>tuple</em>) – intended shape of image</p></li>
<li><p><strong>windows</strong> (<em>3d list</em>) – list of window indices as output by create_windows()</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>tiles</strong> – array where individual windows are labelled with unique index</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>2d array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="morphodynamics.windowing.show_windows">
<span class="sig-prename descclassname"><span class="pre">morphodynamics.windowing.</span></span><span class="sig-name descname"><span class="pre">show_windows</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#morphodynamics.windowing.show_windows" title="Permalink to this definition">¶</a></dt>
<dd><p>Display the sampling-window boundaries and indices.</p>
</dd></dl>

</div>
<div class="section" id="module-morphodynamics">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-morphodynamics" title="Permalink to this headline">¶</a></h2>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./docs/source"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="../../mydocs/Data.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Data formats</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="morphodynamics.plots.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">morphodynamics.plots package</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Cédric Vonesch and Guillaume Witz<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>